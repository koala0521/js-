<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>UI DEMO</title>
	<link type="text/css" href="../css/elf_framework.css" rel="stylesheet"/>
	<link type="text/css" href="../css/elf_ui.css" rel="stylesheet"/>
	<link type="text/css" href="../plugins/css/elf_base.css" rel="stylesheet"/>
	<link type="text/css" href="../plugins/css/elf_components_confirm.css" rel="stylesheet"/>
	<link type="text/css" href="../plugins/css/elf_components_toast.css" rel="stylesheet"/>
	<link type="text/css" href="../plugins/css/elf_components_loading.css" rel="stylesheet"/>
	<link type="text/css" href="../plugins/css/elf_components_grid.css" rel="stylesheet"/>
	<link type="text/css" href="../plugins/css/elf_components_paging.css" rel="stylesheet"/>
	<link type="text/css" href="css/css.css" rel="stylesheet"/>
	<!--加载ELF库文件-->
	<script type="text/javascript" src="../src/v2/elf.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../src/v2/elf_utils.js"></script>
	<script type="text/javascript" src="../src/v2/elf_terminalInfo.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../src/v2/elf_algorithm.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../src/v2/elf_constants.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../src/v2/elf_cssText.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../src/v2/elf_control.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../src/v2/elf_effects.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../src/v2/elf_xEvents.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../src/v2/elf_webSocket.js" charset="UTF-8"></script>
	<!--加载组件-->
	<script type="text/javascript" src="../plugins/elf_components_base.js"></script>
	<script type="text/javascript" src="js/fn.js"></script>
	<script type="text/javascript">
		var page={};
		function onload(){

		}
	</script>
	<style type="text/css">

		.hourWaper > span{
			position: absolute;
			top:16px;
			height: 32px;
			background-color: #f2f2f3;
			display: inline-block;
		}
		.hourWaper {
			position: relative;
			height: 64px;
		}
		.timeGrid tbody tr:nth-child(2N){
			background: #fff;
		}
		.timeGrid tbody tr:nth-child(2N+1){
			background: #f3f3f5;
		}
		.hourWaper span.selected{
			background-color: red;
		}
		.timeGrid table{
			width: 100%;
		}
		.timeGrid thead{background-color: #dce9f9;}
		.timeGrid thead th{}
		.timeGrid thead th.col3{width: 8%;}
		.timeGrid tbody td{vertical-align: middle;height: 64px;}
		.timeGrid .statusInfo{width: 100%;position: relative;vertical-align: middle;}
	</style>
	<script type="text/javascript">
        var page={};
        var data=[
            {name:"科室1",time:"1484175600000",size:"30",data:[{start:"1484176200000",end:"1484209182000"}]},
            //{name:"科室2",time:"1484175600000",size:"40",data:[{start:"1484209152000",end:"1484209182000"},{start:"1484212800000",end:"1484217000000"}]},
            {name:"科室2",time:"1484175600000",size:"40",data:[{start:"1484176800000",end:"1484209212000"},{start:"1484212800000",end:"1484217000000"}]},
            {name:"科室3",time:"1484175600000",size:"100",data:[{start:"1484204400000",end:"1484205660000"}]}
        ];
        //makeTimeGrid(data,7,19,10);
        //data 数据startHour,endHour,开始和结束时间，minimum 最小时间单位
		function makeTimeGrid(data,startHour,endHour,minimum){
			var grid,table,colgroup,thead,tbody;
            	grid=Elf.controls.createElement("div","timeGrid",document.body);
				table=Elf.controls.createElement("table",grid);
            colgroup=Elf.controls.createElement("colgroup",table);
            Elf.controls.createElement("col",{width:"100px"},colgroup);
            Elf.controls.createElement("col",{width:"60px"},colgroup);
            Elf.controls.createElement("col",{width:"100px"},colgroup);
            thead=makeTimeGridHead(startHour,endHour);
            tbody=makeTimeGridBody(data,startHour,endHour,minimum);
            Elf.controls.appendTo(thead,table);
            Elf.controls.appendTo(tbody,table);

            console.log( colgroup );
		}
		function makeTimeGridHead(startHour,endHour){
		    var thead,theadRow,i=startHour;
            thead=Elf.controls.createElement("thead","timeGrid");
            theadRow=Elf.controls.createElement("tr",thead);
            Elf.controls.createElement("th",{innerHTML:"科室"},theadRow);
            Elf.controls.createElement("th",{innerHTML:"容量"},theadRow);
            Elf.controls.createElement("th",{innerHTML:"日期"},theadRow);
            var tth=Elf.controls.createElement("th",theadRow);
            var innerHTable=Elf.controls.createElement("table",{width:"100%"},tth);
            var innergroup=Elf.controls.createElement("colgroup",innerHTable);
            var innerRow=Elf.controls.createElement("tr",innerHTable);
		    for(i=startHour;i<=endHour;i++){
                Elf.controls.createElement("col",{width:100/(endHour-startHour+1)+"%"},innergroup);
                Elf.controls.createElement("th",{innerHTML:i+":00"},innerRow);
			}
			return thead;
		}
		function makeTimeGridBody(data,startHour,endHour,minimum){
			var tbody;
            tbody=Elf.controls.createElement("tbody");
            Elf.utils.each(data,function(index, el) {
                var day,row,ttd,hourWaper,parts;
                sday=new Date(el.time-0);
                sday.setHours(startHour);
                sday.setMinutes(0);
                sday.setSeconds(0);
                day=sday.getTime();
                parts=(endHour-startHour+1)*60/minimum;
				console.info(parts);
                row=Elf.controls.createElement("tr",tbody);
                Elf.controls.createElement("td","col1 tac",{innerHTML:el.name},row);
                Elf.controls.createElement("td","col2 tac",{innerHTML:el.size},row);
                Elf.controls.createElement("td","col3 tac",{innerHTML:(new Date(el.time-0)).format("yyyy-MM-dd")},row);
				ttd=Elf.controls.createElement("td",{colspan:(endHour-startHour+1)},row);
                hourWaper=Elf.controls.createElement("div","hourWaper",ttd);
                if(el.data.length>0){
                    Elf.utils.each(el.data,function(_i,_d) {
                        var start=Math.floor((_d.start-day)/600000);
                        var end=Math.floor((_d.end-day)/600000);
                        //length=end-start;
                        var sd=Elf.controls.createElement("span","selected elf-tooltip-top",{"data-tooltip":(new Date(_d.start-0)).format("yyyy年MM月dd日h小时m分")+"--"+(new Date(_d.end-0)).format("yyyy年MM月dd日hh小时mm分")},hourWaper);
                        Elf.utils.css(sd,{"width":100*(end-start)/parts+"%","left":100*start/parts+"%"});

                    });
                }
            });
			return tbody;
        }
        function onload(){
            makeTimeGrid(data,7,19,10);
            //page.pagingBar=document.getElementById("paging-bar");
			/*page.tableView1=Elf.components.grid({
			 target:document.body
			 });*/
        }
	</script>
</head>
<body onload="onload();">
	<!--<div class="timeGrid">
		<table width="100%">
			<thead>
				<tr>
					<th class="col1">科室</th>
					<th class="col2">容量</th>
					<th class="col3">日期</th>
					<th class="">6:00</th><th class="tac vam">7:00</th><th class="tac vam">8:00</th><th class="tac vam">9:00</th><th class="tac vam">10:00</th><th class="tac vam">11:00</th><th class="tac vam">12:00</th><th class="tac vam">13:00</th><th class="tac vam">14:00</th><th class="tac vam">15:00</th><th class="tac vam">16:00</th><th class="tac vam">17:00</th><th class="tac vam">18:00</th><th class="tac vam">19:00</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>科室1</td>
					<td>30</td>
					<td>2017-01-16</td>
					<td colspan="14">
						<div class="statusInfo">
							<span>ddd</span><span></span>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>-->

</body>
</html>
